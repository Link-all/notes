# 操作系统[[index]](https://github.com/Linkhhh/notes)

- [1. 进程、线程、协程](#1-进程线程协程TOP)
  - [1.1. 简述线程、进程区别和联系？](#11-简述线程进程区别和联系TOP)
  - [1.2. 什么是协程？与线程的区别？](#12-什么是协程与线程的区别TOP)
  - [1.2. 僵尸进程和孤儿进程是什么，分别有什么危害？](#12-僵尸进程和孤儿进程是什么分别有什么危害TOP)
  - [1.4. 进程间通信方式](#14-进程间通信方式TOP)
    - [1.4.1. 进程间通信方式有哪些？](#141-进程间通信方式有哪些TOP)
    - [1.4.2. 共享内存怎么实现？](#142-共享内存怎么实现TOP)
- [2. Linux系统](#2-Linux系统TOP)
  - [2.1. 简述Linux启动流程？](#21-简述Linux启动流程TOP)
  - [2.2. 什么是内核态、用户态？](#22-什么是内核态系统态TOP)
  - [2.3. 用户态怎么进入内核态？](#23-用户态怎么进入内核态TOP)
- [3. 命令](#3-命令TOP)
  - [3.1. Linux下怎么查看一个端口有没有被占用？](#31-Linux下怎么查看一个端口有没有被占用TOP)
  - [3.2. Linux有哪些查询进程命令？](#32-Linux有哪些查询进程命令TOP)
  - [3.3. Linux怎么查看某个进程中的线程？](#33-Linux怎么查看某个进程中的线程TOP)
  - [3.4. Linux如何查看一个进程是否成功启动了?](#34-Linux如何查看一个进程是否成功启动了TOP)
  - [3.5. lsof命令有什么用？](#35-lsof命令有什么用TOP)
  - [3.6. Linux如何查看内存使用情况？](#36-Linux如何查看内存使用情况TOP)
  - [3.7. Linux如何查看网络情况？](#37-Linux如何查看网络情况TOP)

## 1. 进程、线程、协程[[TOP]](#操作系统)

### 1.1. 简述线程、进程区别和联系？[[TOP]](#操作系统)

​		进程和线程都是CPU上下文切换之间的程序执行的部分。是运行中的程序的描述，也是对应于该段CPU执行时间的描述，线程的粒度比进程小。

### 1.2. 什么是协程？与线程的区别？[[TOP]](#操作系统)

​		协程是用户态线程，不同于线程受操作系统调度，更加轻量。

### 1.3. 僵尸进程和孤儿进程是什么，分别有什么危害？[[TOP]](#操作系统)

**孤儿进程**

​		一个父进程退出，而它的一个或多个子进程还在运行，那么那些子进程将成为孤儿进程。孤儿进程将被`init`进程(进程号为1)所收养，并由`init`进程对它们完成状态收集工作。

​		`init`进程会循环地`wait()`它的已经退出的子进程，因此孤儿进程无危害。

**僵尸进程**

​		一个进程使用`fork`创建子进程，如果子进程退出，而父进程并没有调用`wait`或`waitpid`获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中。这种进程称之为僵尸进程。

**危害**：如果进程不调用`wait / waitpid`的话，那么保留的那段信息就不会释放，其进程号就会一直被占用，但是系统所能使用的进程号是有限的，如果大量的产生僵死进程，将因为没有可用的进程号而导致系统不能产生新的进程。

### 1.4. 进程间通信方式[[TOP]](#操作系统)

#### 1.4.1 进程间通信方式有哪些？[[TOP]](#操作系统)

1. 管道

   ​		管道分为有名管道和无名管道，其中无名管道是一种半双工的通信方式，数据只能单向流动，而且只能在具有亲缘关系的进程间使用，一般用于两个不同进程之间的通信。有名管道也是一种半双工的通信方式，但它允许无亲缘关系进程间的通信。

2. 信号

   ​		信号是一种比较复杂的通信方式，信号产生的条件：按键、硬件异常、进程调用kill函数将信号发送给另一个进程、用户调用kill命令将信号发送给其他进程，传递的消息比较少用于通知接收进程某个时间已经发生。

3. 信号量

   ​		信号量是一个计数器，可以用来控制多个线程对共享资源的访问，它不是用于交换大批数据，而用于多线程之间的同步。他常作为一种锁机制。因此，主要作为进程间以及同一个进程内不同线程之间的同步手段。

4. 消息队列

   ​		消息队列是消息的链表，存放在内核中并由消息队列标识符标识，消息队列克服了信号传递信息少，管道只能承载无格式字节流以及缓冲区大小受限等特点。

5. 共享内存

   ​		共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问。他往往与其他通信机制，如信号量配合使用，来实现进程间的同步和通信。

6. 套接字：套接字可用于不同及其间的进程通信。

#### 1.4.2. 共享内存怎么实现？[[TOP]](#操作系统)

​		Linux内核中有一块内存区能够被需要的进程映射到自身的内存空间。因此，进程便能够直接对这块内存区进行读写操作。

**共享内存的实现步骤**

1. **创建共享内存**：通过函数`shmget()`从内存中获取一块共享内存区域，该函数返回值为共享内存的ID。
2. **映射共享内存**：通过函数`shmat()`将上一步获取的共享内存映射到具体的内存空间。

## 2. Linux系统[[TOP]](#操作系统)

### 2.1. 简述Linux启动流程？[[TOP]](#操作系统)

1. 加载内核：首先读入 /boot 目录下的内核文件；
2. 启动初始化进程：运行第一个程序` /sbin/init`，来初始化系统环境；
3. 确定运行级别：确定运行级别（不同的运行级别需要运行不同的开机启动程序）；
4. 加载开机启动程序：init进程根据运行级别，在个目录` /etc/init.d `中逐一加载开机启动程序；
5. 用户登录；
6. 进入Login Shell（命令行界面） ；
7. 打开non-login Shell。

### 2.2. 什么是内核态、用户态？[[TOP]](#操作系统)

​		内核态，或者说CPU的特权模式，是CPU的一种工作状态。操作系统通过跟CPU配合，设置特权模式和用户模式，来防止应用程序进行越权的操作。内核态主要控制计算机的硬件资源，例如协调CPU资源，分配内存资源，并且提供稳定的环境供应用程序运行。

​		运行于用户态的进程可以执行的操作和访问的资源都受到极大的限制，而运行于内核态的进程则可以执行任何操作并且在资源的使用上也没有限制。很多程序开始时运行于用户态，但在执行的过程中，一些操作需要在内核权限下才能执行，这就涉及到一个从用户态切换到内核态的过程。

### 2.3. 用户态怎么进入内核态？[[TOP]](#操作系统)

1. 系统调用；
2. 异常；
3. 外设中断。

## 3. Linux命令[[TOP]](#操作系统)

### 3.1. Linux下怎么查看一个端口有没有被占用？[[TOP]](#操作系统)

```bash
netstat -anp |g rep
```

### 3.2. Linux有哪些查询进程命令？[[TOP]](#操作系统)

```bash
ps -aux   查询内存中进程信息
top       查看内存中进程的动态信息
```

### 3.3. Linux怎么查看某个进程中的线程？[[TOP]](#操作系统)

```bash
ps -xH   查看所有线程信息
top -H   查看进程内部线程信息
```

### 3.4. Linux如何查看一个进程是否成功启动了?[[TOP]](#操作系统)

```bash
ps -ef
lsof -i:6379  通过端口号查询进程
```

### 3.5. lsof命令有什么用？[[TOP]](#操作系统)

​		`lsof`是系统管理/安全的工具。它是指“列出打开文件（lists openfiles），而在Unix中一切（包括网络套接口）都是文件。可以替代`netstat`和`ps`的工作。

### 3.6. Linux如何查看内存使用情况？[[TOP]](#操作系统)

​		`free`和`top`命令。

### 3.7. Linux如何查看网络情况？[[TOP]](#操作系统)

```bash
netstat     查看网络相关状态的
ifconfig    显示配置信息
```
